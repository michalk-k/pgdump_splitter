# Motivation
The main reason why this program has been created is to quickly dump databases into files, representing different database objects.

Why not a single file? \
The result has to be versioned (ie in GIT) and then worked on by teams. A single file means merging conflicts. The more files the structure is split into, the fewer merging conflicts. \
Also, working with small files, and comparing their content (ie in GIT) is more comfortable than with a single big one.

# Features
1. May use `pg_dump` directly
2. Alternatively may parse a dump file, generated earlier by pg_dump
3. Dumps each db object to separate file
4. Allows grouping of related objects into a single file (ie table together with its acls, comments, column comments, defaults etc)
5. Files containing functions have filenames shortened to avoid exceeding the maximum file length allowed by the filesystem/os
   
# Usage
`pgdump_splitter {options}`

The following command-line options control the content and format of the output.

`-m`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mode of dumping db objects. origin - for file organization as present in the database dump. custom - reorganizes db objects storing related ones into single file

`- c`
    	
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The path to `pg_dump` command. Without specifying it, the one available in the system will be used
     
`-f`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path to dump generated by pg_dump. If set, no pg_dump connection will be used

`-h`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies the hostname of the machine on which the server is running. If the value begins with a slash, it is used as the directory for the Unix domain socket. The default is taken from the PGHOST environment variable, if set, else a Unix domain socket connection is attempted.

`-p`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies the TCP port or local Unix domain socket file extension on which the server is listening for connections. Defaults to the PGPORT environment variable, if set, or a compiled-in default (5432)

`- d`

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies the name of the database the `pg_dump` connects to

 `-u`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User name to connect as. Password will be taken from known sources like PGPASSWORD environment variable or .pgpass

`-s`

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Location where structures will be dumped to


**Examples**

`pgdump_splitter -m origin -f dbdump.sql -s /path/to/resulting/structure/`

Creates the result from `dbdump.sql` file generated by pg_dump earlier. Objects are organized into file structures proposed by the `pg_dump`.

`pgdump_splitter -m custom -h 192.168.0.5 p- 5432 -u yourlogin -d database_name -s /path/to/resulting/structure/`

Creates the result from data streamed directly from pg_dump connected to a given database. Files are organized in a way, aggregating related objects into single files (ie objects together with their ACLs).
Password has to be provided in ways accepted by the `pg_dump` (.pgpass, PGPASSWORD env variable etc)
